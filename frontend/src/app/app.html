<main style="padding: 16px; display: grid; gap: 12px; max-width: 800px;">
  <h1>FlashSale Frontend</h1>

  <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
    <button type="button" (click)="login()" *ngIf="!authenticated">Login</button>
    <button type="button" (click)="logout()" *ngIf="authenticated">Logout</button>
    <button type="button" (click)="printToken()" *ngIf="authenticated">Print token</button>
    <button type="button" (click)="showToken()" *ngIf="authenticated">Show token</button>
    <span *ngIf="authenticated">Hello {{ username }}</span>
  </div>

  <div style="display: grid; gap: 8px;">
    <label for="active-org-id">Active Org ID</label>
    <input
      id="active-org-id"
      type="text"
      name="activeOrgInput"
      [(ngModel)]="activeOrgInput"
      placeholder="org-123"
      style="max-width: 320px;"
    />
    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
      <button type="button" (click)="saveActiveOrgId()">Save activeOrgId</button>
      <button type="button" (click)="clearActiveOrgId()">Clear activeOrgId</button>
    </div>
    <p>Saved activeOrgId: {{ savedActiveOrgId ?? '(none)' }}</p>
  </div>

  <div style="display: grid; gap: 8px;">
    <button type="button" (click)="callWhoAmI()" [disabled]="loadingWhoAmI">
      {{ loadingWhoAmI ? 'Calling /api/catalog/context/whoami...' : 'Call whoAmI' }}
    </button>
  </div>

  <pre style="white-space: pre-wrap; overflow: auto;" *ngIf="tokenPreview">{{ tokenPreview }}</pre>

  <div *ngIf="whoAmIResponse" style="display: grid; gap: 4px;">
    <p><strong>tenantId:</strong> {{ whoAmIResponse.tenantId }}</p>
    <p><strong>userId:</strong> {{ whoAmIResponse.userId }}</p>
    <p><strong>roles:</strong> {{ whoAmIResponse.roles.join(', ') }}</p>
    <p><strong>correlationId:</strong> {{ whoAmIResponse.correlationId }}</p>
  </div>

  <p *ngIf="apiError" style="color: #b00020;">{{ apiError }}</p>
</main>

<router-outlet />
